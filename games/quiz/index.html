<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Tsuzuku</title>
        <meta charset="utf-8">
        <meta name="description" content="Search, track, and play games with the unofficial UI for the anime-offline-database">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#fff">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-title" content="Tsuzuku">
        <meta name="apple-mobile-web-app-status-bar-style" content="default">
        <link rel="icon" href="../../images/logo-192.png">
        <link rel="mask-icon" href="../../images/logo.svg" color="#000">
        <link rel="apple-touch-icon" href="../../images/logo-180.png">
        <link rel="manifest" href="../../manifest.webmanifest">
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link rel="preconnect" href="https://raw.githubusercontent.com">
        <link rel="dns-prefetch" href="https://fonts.gstatic.com">
        <link rel="dns-prefetch" href="https://raw.githubusercontent.com">
        <link rel="preload" href="https://fonts.gstatic.com/s/roboto/v27/KFOmCnqEu92Fr1Mu4mxK.woff2" as="font" crossorigin>
        <link rel="preload" href="https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fBBc4.woff2" as="font" crossorigin>
        <link href="./index.css" rel="stylesheet">
    </head>
    <body class="light">
        <noscript>Tsuzuku can't run without JavaScript</noscript>
        <header>
            <a href="../../" rel="noreferrer">...</a>
            <span class="half-separator"></span>
            <span>/</span>
            <span class="half-separator"></span>
            <a href="../" rel="noreferrer">Games</a>
            <span class="half-separator"></span>
            <span>/</span>
            <span class="half-separator"></span>
            <span class="bold">Quiz</span>
            <span class="flex-separator"></span>
            <a href="https://github.com/kuzutsu/tsuzuku" target="_blank">GitHub</a>
            <span class="separator"></span>
            <span class="theme" title="Toggle theme" tabindex="0">
                <svg viewBox="0 0 24 24" width="19" height="19">
                    <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9s9-4.03 9-9c0-0.46-0.04-0.92-0.1-1.36c-0.98 1.37-2.58 2.26-4.4 2.26 c-2.98 0-5.4-2.42-5.4-5.4c0-1.81 0.89-3.42 2.26-4.4C12.92 3.04 12.46 3 12 3L12 3z"></path>
                </svg>
            </span>
        </header>
        <main>
            <div class="menu">
                <span>High</span>
                <span class="half-separator"></span>
                <span class="high bold" tabindex="0"></span>
                <span class="separator"></span>
                <span>Score</span>
                <span class="half-separator"></span>
                <span class="score bold" tabindex="0"></span>
                <span style="width: 100%; min-width: 14px;"></span>
                <span class="settings" title="Settings" tabindex="0" style="display: inline-flex; align-items: center;">
                    <svg viewBox="0 0 24 24" width="17" height="17" style="fill: #aaa;">
                        <path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"></path>
                    </svg>
                </span>
            </div>
            <div class="settings-container" style="display: none;">
                <div>
                    <span style="color: #aaa;">Changing any setting will reset both scores</span>
                </div>
                <div>
                    <label for="selection">Selection</label>
                    <span class="flex-separator"></span>
                    <select id="selection">
                        <option>single</option>
                        <option>multiple</option>
                    </select>
                </div>
                <div>
                    <label for="type">Type</label>
                    <span class="flex-separator"></span>
                    <select id="type">
                        <option>tag</option>
                        <option>year (without operators)</option>
                        <option>year (with operators)</option>
                        <option>episodes (without operators)</option>
                        <option>episodes (with operators)</option>
                        <option>season</option>
                        <option>random</option>
                    </select>
                </div>
                <div>
                    <label for="choices">Number of choices</label>
                    <span class="flex-separator"></span>
                    <select id="choices">
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                        <option>6</option>
                        <option>7</option>
                        <option>8</option>
                        <option>9</option>
                        <option>10</option>
                    </select>
                </div>
                <div>
                    <label for="negative">Toggle negative score</label>
                    <span class="flex-separator"></span>
                    <input id="negative" type="checkbox"></input>
                </div>
                <div>
                    <label for="reset-incorrect">Reset score when incorrect</label>
                    <span class="flex-separator"></span>
                    <input id="reset-incorrect" type="checkbox"></input>
                </div>
            </div>
            <div class="query">
                <span class="reload" title="Reload" tabindex="0">
                    <svg viewBox="0 0 24 24" width="17" height="17">
                        <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"></path>
                    </svg>
                </span>
                <span class="separator"></span>
                <div class="query-container">
                    <a href rel="noreferrer"></a>
                </div>
                <span class="separator"></span>
                <span class="submit bold" tabindex="0"></span>
            </div>
            <div class="choice"></div>
        </main>
        <script>
            switch (localStorage.getItem('theme')) {
                case 'dark':
                    document.body.classList.remove('light');
                    document.body.classList.add('dark');
                    document.head.querySelector('[name="theme-color"]').content = '#000';
                    document.querySelector('.theme path').setAttribute('d', 'M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5s5-2.24 5-5S14.76 7 12 7L12 7z M2 13l2 0c0.55 0 1-0.45 1-1s-0.45-1-1-1l-2 0 c-0.55 0-1 0.45-1 1S1.45 13 2 13z M20 13l2 0c0.55 0 1-0.45 1-1s-0.45-1-1-1l-2 0c-0.55 0-1 0.45-1 1S19.45 13 20 13z M11 2v2 c0 0.55 0.45 1 1 1s1-0.45 1-1V2c0-0.55-0.45-1-1-1S11 1.45 11 2z M11 20v2c0 0.55 0.45 1 1 1s1-0.45 1-1v-2c0-0.55-0.45-1-1-1 C11.45 19 11 19.45 11 20z M5.99 4.58c-0.39-0.39-1.03-0.39-1.41 0c-0.39 0.39-0.39 1.03 0 1.41l1.06 1.06 c0.39 0.39 1.03 0.39 1.41 0s0.39-1.03 0-1.41L5.99 4.58z M18.36 16.95c-0.39-0.39-1.03-0.39-1.41 0c-0.39 0.39-0.39 1.03 0 1.41 l1.06 1.06c0.39 0.39 1.03 0.39 1.41 0c0.39-0.39 0.39-1.03 0-1.41L18.36 16.95z M19.42 5.99c0.39-0.39 0.39-1.03 0-1.41 c-0.39-0.39-1.03-0.39-1.41 0l-1.06 1.06c-0.39 0.39-0.39 1.03 0 1.41s1.03 0.39 1.41 0L19.42 5.99z M7.05 18.36 c0.39-0.39 0.39-1.03 0-1.41c-0.39-0.39-1.03-0.39-1.41 0l-1.06 1.06c-0.39 0.39-0.39 1.03 0 1.41s1.03 0.39 1.41 0L7.05 18.36z');
                    break;

                case 'light':
                    break;

                default:
                    localStorage.setItem('theme', 'light');
                    break;
            }

            if (!localStorage.getItem('quiz')) {
                localStorage.setItem('quiz', JSON.stringify({
                    choices: 4,
                    high: 0,
                    negative: true,
                    random: false,
                    resetIncorrect: false,
                    score: 0,
                    selection: 'single',
                    type: 'tag'
                }));
            }

            const value = JSON.parse(localStorage.getItem('quiz'));

            document.querySelector('#choices').value = value.choices;
            document.querySelector('#selection').value = value.selection;

            if (value.negative) {
                document.querySelector('#negative').checked = true;
            } else {
                document.querySelector('#negative').checked = false;
            }

            if (value.resetIncorrect) {
                document.querySelector('#reset-incorrect').checked = true;
            } else {
                document.querySelector('#reset-incorrect').checked = false;
            }

            if (value.random) {
                document.querySelector('#type').value = 'random';
            } else {
                document.querySelector('#type').value = value.type;
            }

            if ('serviceWorker' in navigator) {
                navigator
                    .serviceWorker
                    .register('../../sw.js')
                    .then((registration) => {
                        registration.addEventListener('updatefound', () => {
                            let r = registration.installing;
                            
                            r.addEventListener('statechange', () => {
                                if (r.state === 'installed') {
                                    r.postMessage({
                                        update: true
                                    });
                                }
                            });
                        });
                    });
            }

            document.querySelector('.theme').addEventListener('click', () => {
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.remove('dark');
                    document.body.classList.add('light');
                    document.head.querySelector('[name="theme-color"]').content = '#fff';
                    document.querySelector('.theme path').setAttribute('d', 'M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9s9-4.03 9-9c0-0.46-0.04-0.92-0.1-1.36c-0.98 1.37-2.58 2.26-4.4 2.26 c-2.98 0-5.4-2.42-5.4-5.4c0-1.81 0.89-3.42 2.26-4.4C12.92 3.04 12.46 3 12 3L12 3z');
                    localStorage.setItem('theme', 'light');
                } else {
                    document.body.classList.remove('light');
                    document.body.classList.add('dark');
                    document.head.querySelector('[name="theme-color"]').content = '#000';
                    document.querySelector('.theme path').setAttribute('d', 'M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5s5-2.24 5-5S14.76 7 12 7L12 7z M2 13l2 0c0.55 0 1-0.45 1-1s-0.45-1-1-1l-2 0 c-0.55 0-1 0.45-1 1S1.45 13 2 13z M20 13l2 0c0.55 0 1-0.45 1-1s-0.45-1-1-1l-2 0c-0.55 0-1 0.45-1 1S19.45 13 20 13z M11 2v2 c0 0.55 0.45 1 1 1s1-0.45 1-1V2c0-0.55-0.45-1-1-1S11 1.45 11 2z M11 20v2c0 0.55 0.45 1 1 1s1-0.45 1-1v-2c0-0.55-0.45-1-1-1 C11.45 19 11 19.45 11 20z M5.99 4.58c-0.39-0.39-1.03-0.39-1.41 0c-0.39 0.39-0.39 1.03 0 1.41l1.06 1.06 c0.39 0.39 1.03 0.39 1.41 0s0.39-1.03 0-1.41L5.99 4.58z M18.36 16.95c-0.39-0.39-1.03-0.39-1.41 0c-0.39 0.39-0.39 1.03 0 1.41 l1.06 1.06c0.39 0.39 1.03 0.39 1.41 0c0.39-0.39 0.39-1.03 0-1.41L18.36 16.95z M19.42 5.99c0.39-0.39 0.39-1.03 0-1.41 c-0.39-0.39-1.03-0.39-1.41 0l-1.06 1.06c-0.39 0.39-0.39 1.03 0 1.41s1.03 0.39 1.41 0L19.42 5.99z M7.05 18.36 c0.39-0.39 0.39-1.03 0-1.41c-0.39-0.39-1.03-0.39-1.41 0l-1.06 1.06c-0.39 0.39-0.39 1.03 0 1.41s1.03 0.39 1.41 0L7.05 18.36z');
                    localStorage.setItem('theme', 'dark');
                }
            });
        </script>
        <script defer type="module" src="index.js"></script>
    </body>
</html>